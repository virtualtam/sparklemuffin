# Run SparkleMuffin locally
## Goals
This guide shows how to run SparkleMuffin locally on your computer, in development
mode, with debug logging enabled.

<div class="warning">
This setup is only fit for testing purposes, and should not be used as-is in
production (or a public-facing server).
</div>

## Prerequisites
- [Install Docker](https://docs.docker.com/engine/install/)
- [Install Docker Compose](https://docs.docker.com/compose/install/)

If you are not familiar with Docker or Docker Compose, take a look at the quickstart guides:

- [Getting started with Docker](https://docs.docker.com/get-started/)
- [Getting started with Docker Compose](https://docs.docker.com/compose/gettingstarted/)
- [Docker 101 Tutorial](https://www.docker.com/101-tutorial/)

## Run services with Docker Compose
Create a new directory and download the example Docker Compose configuration:

```shell
$ mkdir -p sparklemuffin
$ cd sparklemuffin
$ wget https://raw.githubusercontent.com/virtualtam/sparklemuffin/main/docker-compose.yml
```

Pull the Docker images for PostgreSQL and SparkleMuffin:

```shell
$ docker compose pull
```

Run PostgreSQL and SparkleMuffin:

```shell
$ docker compose up -d
```

## Apply database migrations
Use the `sparklemuffin migrate` command to apply database migrations:

```shell
$ docker compose exec sparklemuffin sparklemuffin migrate
```

## Create a first administrator user
Use the `sparklemuffin createadmin` command to create the `admin@local.dev` user;
a strong password will be generated automatically for you:

```shell
$ docker compose exec sparklemuffin \
    sparklemuffin createadmin \
		--displayname Admin \
		--email admin@dev.local \
		--nickname admin
```

## Log in to the SparkleMuffin
You are now ready to access SparkleMuffin's Web interface by opening
[http://localhost:8080](http://localhost:8080) in your Web browser, and log in
using the credentials from the previous step:

- login: `admin@dev.local`;
- password: use the password generated by the `sparklemuffin createadmin` command.

## Cleanup - When you are done using SparkleMuffin
### Stop the services
Stop running containers with:

```shell
$ docker compose stop
```

### Stop the services, remove containers and PostgreSQL data volume
```shell
$ docker compose down -v
```
